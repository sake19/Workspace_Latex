\documentclass[11pt]{article}
% 쪽번호 생성
% \usepackage{plain}

\usepackage{fancyhdr}
% \usepackage{headings}

\usepackage{amsmath}
% use UTF8 encoding
\usepackage[utf8]{inputenc}
% use KoTeX package for Korean
\usepackage{kotex}

\usepackage{hyperref}

\usepackage{graphicx}

% \setlength{\headheight}{30pt}

% \pagestyle{headings}
\pagestyle{fancy}

\fancyhead[O]{output you want}

% \markright{John Smith\hfill On page styles\hfill}

\renewcommand{\headrulewidth}{4pt}
% \renewcommand{\footrulewidth}{2pt}

\fancyhf{}

% \fancyhead[L]{\includegraphics[width=1cm]{example-image-a}}
% \fancyhead[C]{}
% \fancyhead[R]{\rightmark}
% \fancyfoot[L]{ABC}
% \fancyfoot[C]{\textcopyright xyz}
% \fancyfoot[R]{\thepage}

% \hypersetup{
%     colorlinks=true,   
%     urlcolor=red,
% }

\title{Hall sensor}

\author{Minwoo Jung}

\begin{document}

\maketitle

\section{Introduction}
\indent \\Height level sensors for vehicles have been around for several years and are becoming increasingly popular as more vehicles incorporate electronic systems for suspension control and other functions. The basic idea behind a height level sensor is to measure the distance between the vehicle's chassis and the ground, which can be used to adjust the vehicle's suspension system and maintain a consistent ride height.

The concept of height level sensors can be traced back to the early days of the automobile, where some vehicles were equipped with manual leveling systems that allowed the driver to adjust the suspension manually. However, with the advent of electronic control systems, the use of sensors has become more common.

There are several types of sensors that can be used for height level measurement, including ultrasonic sensors, laser sensors, infrared sensors, and potentiometer sensors. Each type of sensor has its own advantages and disadvantages, and the choice of sensor will depend on factors such as cost, accuracy, and environmental conditions.

One of the primary applications of height level sensors is in suspension control systems. By measuring the vehicle's height level and making adjustments to the suspension system, these systems can improve handling and stability, and provide a more comfortable ride for passengers. Height level sensors can also be used for load leveling, where they can detect changes in the weight distribution of the vehicle and adjust the suspension to maintain a level ride.

In addition to suspension control, height level sensors can be used for other applications as well. For example, some vehicles are equipped with headlight leveling systems that adjust the angle of the headlights based on the vehicle's height level, to prevent blinding oncoming drivers.

Overall, height level sensors are an important component of modern vehicle electronic systems. They provide valuable information that can be used to improve handling, stability, and safety, and are becoming increasingly common in a wide range of vehicles.

\indent \\A height level sensor for a vehicle is a device that measures the distance between the vehicle's chassis and the ground. This information is important for a variety of applications, such as:

Suspension control: The height level sensor can be used to adjust the vehicle's suspension system to maintain a consistent ride height, which can improve handling and stability.

Load leveling: The sensor can be used to detect changes in the weight distribution of the vehicle and adjust the suspension to maintain a level ride.

Headlight leveling: Some vehicles are equipped with headlight leveling systems that adjust the angle of the headlights based on the vehicle's height level, to prevent blinding oncoming drivers.

There are several types of height level sensors that can be used for vehicles, including:

Ultrasonic sensors: These sensors use high-frequency sound waves to measure the distance between the vehicle's chassis and the ground.

Laser sensors: These sensors use a laser beam to measure the distance between the vehicle and the ground.

Infrared sensors: These sensors use infrared light to measure the distance between the vehicle and the ground.

Potentiometer sensors: These sensors use a rotary potentiometer to measure changes in the suspension system and calculate the vehicle's height level.

The choice of sensor will depend on factors such as cost, accuracy, and environmental conditions. For example, ultrasonic sensors may be less accurate in wet or snowy conditions, while laser sensors may be more expensive than other options. Ultimately, the goal of a height level sensor is to provide accurate and reliable information to the vehicle's suspension and other systems, to ensure a safe and comfortable ride.

\subsection{토양습도와 전기전도도}
\indent \\전기전도성은 Ohm의 법칙에 따라 전기저항(R)과 전류(I)와의 관계로 정의됩니다. Ohm의 법칙은 다음과 같습니다.

R = V/I

여기서 R은 전기저항을, V는 전압을, I는 전류를 나타냅니다. 이 때, 전류가 일정하다면 전압과 전기저항은 비례 관계에 있습니다. 따라서, 전기저항이 작을수록 전압이 낮아지게 되며, 이는 전기전도도가 증가하는 것으로 해석할 수 있습니다.

토양의 경우, 전기전도도는 토양의 전기저항과 같이 토양 내부를 통과하는 전류와 전압 간의 관계로 나타낼 수 있습니다. 따라서, 전기전도도는 다음과 같은 수식으로 표현할 수 있습니다.

σ = I / V

여기서 σ는 전기전도도를, I는 전류를, V는 전압을 나타냅니다. 토양의 전기전도도는 토양 내부의 물 분자의 양과 이동성에 따라 결정되므로, 토양 습도가 높을수록 전기전도도가 증가하게 됩니다.

따라서, 이를 이용하여 전기전도도 센서를 이용하여 토양의 전기전도도를 측정하고 이를 토양 습도로 변환하는 방법이 사용됩니다. 이를 이용하여 작물의 수분 관리를 할 수 있으며, 농업 분야에서 널리 사용되고 있습니다.
\subsection{토양 온도와 토양 습도}
\indent \\낮 시간동안 토양의 온도가 상승하면 토양 내부에 있는 물 분자들의 운동에너지가 증가하게 됩니다. 이는 분자들 간의 상호작용력을 극복하기 위해 물 분자들이 더욱 빠르게 움직이고, 이로 인해 수증기의 증발속도가 증가합니다. 따라서, 토양 습도는 상승하게 됩니다.

이와 더불어, 토양 온도가 증가하면 토양 내부의 물 분자들이 더 높은 에너지 상태에 있게 되어서 상대적으로 덜 결합되게 됩니다. 이는 물 분자들의 이동성을 증가시키며, 이로 인해 수분이 더욱 자유롭게 이동할 수 있게 됩니다. 따라서, 토양 습도의 상승에 기여하는 요인 중 하나는 이동성이 증가하는 것입니다.

총론적으로, 낮 시간동안 토양의 온도가 상승하면 토양 내부의 수분이 증발하는 속도가 증가하고, 물 분자들의 이동성이 증가하여 토양 습도가 상승하는 것으로 보입니다.

\subsubsection{하드웨어 구조}
\indent \\관개제어기의 하드웨어는 데이터 처리와 블루투스 통신을 위한 MCU, 솔레노이드 제어를 위한 Relay, 토양 센서 데이터 수집을 위한 RS-485 트랜시버로 구성되어 있다. 센서와 솔레노이드 전원은 DC-12V 입력을 인가한다. RS-485 트랜시버는 

\subsubsection{RS-485 통신환경}
\indent \\RS-485 통신은 송/수신을 동시에 할 수 없는 반이중(Half-duplex) 방식을 채택하고 있어서 트랜시버에 RX와 TX를 커트롤하는 핀이 있다. 또한 데이터 전송 거리는 최대 1.2km로 장거리 전송이 가능하다. 일반적으로 100kbps 전송 속도에서 약 1.2km 전송거리를 가지며, 10Mbps 전송 속도로 올리면 전송거리가 12m로 줄어든다. RS-485통신은 하나의 노드에 여러 대의 장비를 병렬로 연결할 수 있는 멀티드랍(Multi-drop)이 가능하다.

\begin{table}
    \centering
    \caption{Communication Basic Parameters}
    \label{t1}
    % \begin{tabular}{|c|c|c|c|}
    \resizebox{\textwidth}{!}
    {%
    \begin{tabular}{|c|c|}
    \noalign{\smallskip}\noalign{\smallskip}\hline
    % & column1 & column2 & column3 \\
    PARAMETERS & content \\
    % \hline
    % row1 & - & - & - \\
    % \hline
    % row2 & - & - & - \\
    % \hline
    % row3  & - & - & - \\
    % \hline
    \hline
    Protocol & Modbus RTU \\
    \hline
    Data bits & 8 bit \\
    \hline
    Parity  & No \\
    \hline
    Stop bit  & 1 bit \\
    \hline
    Error checking  & CRC (redundant loop code) \\
    \hline
    Baud rate  & 2400 bps/ 4800 bps/ 9600 bps can be set factory defaults to 9600 bps\\
    \hline
    \end{tabular}
    }
\end{table}

\begin{table}
    \centering
    \caption{Register Address}
    \label{t2}
    \resizebox{\textwidth}{!}
    {
    \begin{tabular}{|c|c|c|c|}
    % \resizebox{\textwidth}{!}
    % {
    % \begin{tabular}{|c|c|}
    \noalign{\smallskip}\noalign{\smallskip}\hline
    % & column1 & column2 & column3 \\
    Register Address & PIC Configuration Address & content & Operation \\
    % \hline
    % row1 & - & - & - \\
    % \hline
    % row2 & - & - & - \\
    % \hline
    % row3  & - & - & - \\
    % \hline
    \hline
    0002H & 40003 & Soil humidity & Read-Only \\
    \hline
    0003H & 40004 & Soil temperature & Read-Only \\
    \hline
    0100H & 40101 & Device Address & Read-Write \\
    \hline
    0101H & 40102 & Baud Rate & Read-Write \\
    \hline    
    \end{tabular}
    }
\end{table}

% \begin{table}
%     \centering
%     \caption{Message Frame}
%     \label{t3}
%     % \resizebox{\textwidth}{!}
%     % {
%     \begin{tabular}{|c|c|c|c|c|c|}
%     % \resizebox{\textwidth}{!}
%     % {
%     % \begin{tabular}{|c|c|}
%     \noalign{\smallskip}\noalign{\smallskip}\hline
%     % & column1 & column2 & column3 \\
%     Inquiry Frame & & & & & &\\
%     % \hline
%     % row1 & - & - & - \\
%     % \hline
%     % row2 & - & - & - \\
%     % \hline
%     % row3  & - & - & - \\
%     % \hline
%     \hline
%     Address Code & Function Code & Start Address & Data Length & CRC_L & CRC_H \\
%     \hline
%     Answer Frame & & & & & & \\
%     \hline
%     Address Code & Function Code & Number of Valid Bytes & Value & CRC_L & CRC_H \\    
%     \hline
%     \end{tabular}
%     % }
% \end{table}

\subsubsection{메시지구조}
\indent \\MODBUS는 산업용 표준 직렬 통신 프로토콜이다. MODBUS는 마스트와 슬레이브 프레임워크로 구성되어 있다. 슬레이브는 고유 주소를 가진다. 토양 센서에서 제공하는 MODBUS 기본 파라미터는 표\ref{t1}과 같다. 표\ref{t2}는 센서의 레지스터 주소값을 보여주고 있다. 레지스터 주소값을 기반으로 센싱 데이터를 요청할 수 있고, 센서 고유 아이디와 전송속도를 변경할 수 있다. %표\ref{t3}는 request message와 respond message 구조를 보여주고 있다.%
 

\subsection{게이트웨이}
\indent \\게이트웨이는 다수의 관개제어기로부터 토양 데이터를 수집하고, MQTT 프로토콜을 기반으로 서버로 데이터를 전송한다. 게이트웨이의 멀티태스킹을 위해서 유비노스 운영체제를 탑재하였다. 

\subsection{서버}
\indent \\서버는 MQTT(Message Queuing Telemetry Transport) 브로커와 데이터베이스로 구성되어 있다. MQTT는 publish/subscribe/broker를 사용하는 프로토콜로서 subscriber는 토픽을 구독하기 위한 목적,publisher는 토픽을 발행하기 위한 목적으로 broker와 연결된다. 

\end{document}